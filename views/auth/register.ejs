<form action="/register" method="POST" class="auth-form">
    <div class="form-group">
        <label for="username">Username</label>
        <div class="input-icon">
            <input
                    type="text"
                    id="username"
                    name="username"
                    class="form-control <%= typeof errors !== 'undefined' && errors.find(err => err.param === 'username') ? 'is-invalid' : '' %>"
                    placeholder="Enter username"
                    value="<%= typeof username !== 'undefined' ? username : '' %>"
                    required
                    minlength="3"
            >
            <i class="fas fa-user"></i>
        </div>
    </div>

    <div class="form-group">
        <label for="password">Password</label>
        <div class="input-icon">
            <input
                    type="password"
                    id="password"
                    name="password"
                    class="form-control <%= typeof errors !== 'undefined' && errors.find(err => err.param === 'password') ? 'is-invalid' : '' %>"
                    placeholder="Enter password"
                    required
                    minlength="6"
            >
            <i class="fas fa-lock"></i>
        </div>
    </div>

    <div class="form-group">
        <label for="password2">Confirm Password</label>
        <div class="input-icon">
            <input
                    type="password"
                    id="password2"
                    name="password2"
                    class="form-control <%= typeof errors !== 'undefined' && errors.find(err => err.param === 'password2') ? 'is-invalid' : '' %>"
                    placeholder="Confirm password"
                    required
            >
            <i class="fas fa-lock"></i>
        </div>
    </div>

    <% if (typeof user !== 'undefined' && user && user.role === 'Admin') { %>
        <div class="form-group">
            <label for="role">Role</label>
            <select id="role" name="role" class="form-control">
                <option value="Viewer" <%= typeof role !== 'undefined' && role === 'Viewer' ? 'selected' : '' %>>Viewer</option>
                <option value="Admin" <%= typeof role !== 'undefined' && role === 'Admin' ? 'selected' : '' %>>Administrator</option>
            </select>
        </div>
    <% } %>

    <div class="form-group">
        <button type="submit" class="btn btn-primary">
            <i class="fas fa-user-plus"></i> Register
        </button>
    </div>
</form>

<div class="auth-links">
    <% if (typeof user === 'undefined' || !user) { %>
        <p>Already have an account? <a href="/login">Login</a></p>
    <% } else { %>
        <p>Return to <a href="/users">User Management</a></p>
    <% } %>
</div>